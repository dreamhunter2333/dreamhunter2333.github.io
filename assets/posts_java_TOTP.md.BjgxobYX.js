import{_ as s,c as i,o as a,aj as t}from"./chunks/framework.B4uOnG9Z.js";const c=JSON.parse('{"title":"基于时间的一次性密码算法","description":"","frontmatter":{"title":"基于时间的一次性密码算法","date":"2021-04-21 08:58:11","categories":["java"],"tags":["java"]},"headers":[],"relativePath":"posts/java/TOTP.md","filePath":"posts/java/TOTP.md","lastUpdated":1719554298000}'),n={name:"posts/java/TOTP.md"},h=t(`<h1 id="基于时间的一次性密码算法" tabindex="-1">基于时间的一次性密码算法 <a class="header-anchor" href="#基于时间的一次性密码算法" aria-label="Permalink to &quot;基于时间的一次性密码算法&quot;">​</a></h1><h2 id="java-googleauth" tabindex="-1">java GoogleAuth <a class="header-anchor" href="#java-googleauth" aria-label="Permalink to &quot;java GoogleAuth&quot;">​</a></h2><p><a href="https://github.com/wstrange/GoogleAuth" target="_blank" rel="noreferrer">GoogleAuth</a></p><p>Maven:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;com.warrenstrange&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;googleauth&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1.4.0&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Usage</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GoogleAuthenticator gAuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GoogleAuthenticator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> isCodeValid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gAuth.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">authorize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(secretKey, password);</span></span></code></pre></div><p>Clinet</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GoogleAuthenticator gAuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GoogleAuthenticator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gAuth.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getTotpPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(secretKey);</span></span></code></pre></div><h2 id="python-pyotp" tabindex="-1">python pyotp <a class="header-anchor" href="#python-pyotp" aria-label="Permalink to &quot;python pyotp&quot;">​</a></h2><p><a href="https://github.com/pyauth/pyotp" target="_blank" rel="noreferrer">pyotp</a></p><p>Google Authenticator Compatible</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">totp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pyotp.TOTP(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;base32secret3232&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">totp.now() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># =&gt; &#39;492039&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OTP verified for current time</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">totp.verify(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;492039&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># =&gt; True</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time.sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">totp.verify(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;492039&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># =&gt; False</span></span></code></pre></div>`,13),e=[h];function p(l,k,r,E,d,o){return a(),i("div",null,e)}const y=s(n,[["render",p]]);export{c as __pageData,y as default};
